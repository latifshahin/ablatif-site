<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>

  <title>Loan EMI Calculator (Bangladesh) | Declining Balance vs Equal Principal ‚Äì Schedule</title>
  <meta name="description" content="Free EMI calculator for Bangladesh: generate full loan amortization schedule with Declining Balance (reducing) EMI and Equal Principal methods. Compare total interest, monthly breakdown, and print/download."/>
  <meta name="robots" content="index, follow"/>
  <link rel="canonical" href="https://ablatif.com/emi/loan_emi_full.html"/>

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <!-- ChartJS -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <!-- QR Code JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

  <!-- Google Analytics (keep your existing ID) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-X4YNW0E3XG"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-X4YNW0E3XG');
  </script>
  
  <!-- AdSense -->
  <script async crossorigin="anonymous"
          src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3608304969182163"></script>

  <style>
    /* ============================================
          GLOBAL STYLES
    ============================================ */
    body { background:#eef1f5; margin:0; }
    .card { border-radius:12px; box-shadow:0 4px 10px rgba(0,0,0,0.12); }

    /* QR CODE */
    .qr-box{
      width:135px; height:135px; padding:6px; background:#fff;
      border-radius:8px; border:2px solid #444; margin:auto;
      box-shadow:0 2px 6px rgba(0,0,0,0.15);
    }

    /* Alerts */
    .alert-custom{
      background:#ffe5e5; border-left:6px solid #d00; padding:12px; border-radius:6px;
    }
    .alert-success-custom{
      background:#e8ffe8; border-left:6px solid #0a0; padding:12px; border-radius:6px;
    }

    /* Graph */
    .chart-container{
      height:180px !important; max-height:180px !important; padding:0 !important;
    }

    /* ============================================
          PRINT MODE
    ============================================ */
    @media print {
      #inputSection, #actions, #topControls, .nav-tabs, .topbar, .footer-trust {
        display:none !important;
      }
      .card{ border:1px solid #000; box-shadow:none; }
      .table-responsive{
        transform:scale(0.82); transform-origin:top left; width:120%;
      }
      table{ font-size:11px !important; }
      th, td{ padding:3px 5px !important; }
      .chart-container{ display:none !important; }
    }

    /* ===== AdSense-friendly Floating Topbar (Matched Width) ===== */
    :root{ --maxw:1100px; --card:#fff; --muted:#64748b; --ink:#0f172a; --bd:rgba(0,0,0,.10); }
    .page-wrap{ max-width:var(--maxw); margin:0 auto; padding:14px 14px 0; }
    .topbar{
      position:sticky; top:10px; z-index:9999;
      background:var(--card);
      border:1px solid var(--bd);
      box-shadow:0 6px 18px rgba(0,0,0,.06);
      border-radius:16px;
      padding:12px 14px;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .brand h1{ margin:0; font-size:16px; font-weight:900; color:var(--ink); }
    .brand p{ margin:0; font-size:12px; color:var(--muted); }
    .top-actions{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .tbtn{
      border:1px solid var(--bd);
      background:#fff;
      padding:10px 12px;
      border-radius:12px;
      cursor:pointer;
      font-weight:800;
      font-size:13px;
      color:var(--ink);
      text-decoration:none;
      line-height:1;
    }
    .tbtn.primary{ background:var(--ink); color:#fff; border-color:var(--ink); }
    .tbtn:hover{ opacity:.92; }
    @media(max-width:700px){
      .topbar{ top:6px; }
      .brand p{ display:none; }
    }

    /* Footer trust links */
    .footer-trust{
      max-width:var(--maxw);
      margin:26px auto 18px;
      padding:16px 14px;
      border-top:1px solid rgba(0,0,0,.08);
      color:var(--muted);
      font-size:13px;
      text-align:center;
    }
    .footer-trust a{ color:inherit; text-decoration:underline; font-weight:700; }
  </style>

  <script type="application/ld+json">
  {
    "@context":"https://schema.org",
    "@type":"FAQPage",
    "mainEntity":[
      {
        "@type":"Question",
        "name":"What is EMI?",
        "acceptedAnswer":{"@type":"Answer","text":"EMI (Equated Monthly Instalment) is the fixed monthly payment for a loan, consisting of principal and interest. In reducing balance loans, interest is calculated on the outstanding principal."}
      },
      {
        "@type":"Question",
        "name":"Which EMI method is cheaper?",
        "acceptedAnswer":{"@type":"Answer","text":"Equal Principal often results in lower total interest because principal reduces faster, but early instalments are higher. Declining EMI offers smoother payments but may increase total cost depending on rate and tenure."}
      },
      {
        "@type":"Question",
        "name":"Why does bank EMI differ from calculator EMI?",
        "acceptedAnswer":{"@type":"Answer","text":"Bank EMI may differ due to processing fees, insurance, rounding conventions, grace periods, and policy changes. Always verify final figures with the bank."}
      }
    ]
  }
  </script>

</head>

<body class="py-4">

  <!-- Floating Topbar -->
  <div class="page-wrap">
    <div class="topbar"
</div>
</div>

  <!-- EDUCATIONAL INTRO (AdSense-friendly) -->
  <section class="page-wrap" id="intro-education">
    <div class="card p-4 mb-4">
      <h2>Loan EMI Calculator ‚Äî How to Use & What It Means</h2>
      <p class="text-muted">
        This calculator helps you estimate monthly instalments (EMI) and compare
        <strong>Declining Balance (reducing)</strong> and <strong>Equal Principal</strong> methods.
        The goal is not just to calculate EMI, but to understand <em>total interest</em>,
        monthly cash-flow impact, and affordability before taking a loan in Bangladesh.
      </p>

      <h3 class="mt-3">How to use this calculator</h3>
      <ol>
        <li>Enter the <strong>loan amount</strong>, <strong>tenure</strong>, and <strong>interest rate</strong>.</li>
        <li>If applicable, add your <strong>monthly salary</strong> to check affordability.</li>
        <li>Click <strong>Calculate EMI</strong> to view schedules and summaries.</li>
        <li>Compare tabs to see which method reduces total cost.</li>
      </ol>

      <div class="alert alert-warning mt-3">
        <strong>Important:</strong> EMI shown here is an estimate. Bank EMI may differ due to
        fees, insurance, rounding rules, and policy changes.
      </div>

      <!-- TODO BLOCK -->
      <div class="mt-3 text-muted">
        <strong>TODO (write later):</strong>
        Add 200‚Äì400 words here explaining a real example:
        borrower income, existing obligations, safe EMI range, and how banks evaluate repayment capacity.
      </div>
    </div>
  </section>

<div class="page-wrap">
    <div class="topbar" role="navigation" aria-label="Top navigation">
      <div class="brand">
        <h1 id="tbTitle">Loan EMI Calculator</h1>
        <p id="tbSub">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‚Ä¢ Declining Balance ‡¶¨‡¶®‡¶æ‡¶Æ Equal Principal</p>
      </div>
      <div class="top-actions">
        <a class="tbtn" id="tbMain" href="/">‚Üê ‡¶Æ‡ßá‡¶á‡¶® ‡¶∏‡¶æ‡¶á‡¶ü</a>
        <a class="tbtn" id="tbBlog" href="/blog/">‡¶¨‡ßç‡¶≤‡¶ó</a>
        <button class="tbtn primary" id="langToggleBtn" type="button" aria-label="Toggle language">EN</button>
      </div>
    </div>
  </div>

  <div class="page-wrap">
    <div class="container">

      <!-- ============================================
            PAGE TITLE / CONTROLS (NO LANGUAGE BUTTONS HERE)
      ============================================ -->
      <div class="d-flex justify-content-between align-items-center mb-3" id="topControls">
        <h1 class="fw-bold" id="mainTitle">‡¶ã‡¶£ ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á ‡¶ì ‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞</h1>

        <div class="d-flex gap-3">
          <div class="btn-group">
            <button class="btn btn-sm btn-outline-secondary" id="theme-light" type="button" title="Light">üåï</button>
            <button class="btn btn-sm btn-outline-secondary" id="theme-print" type="button" title="Print Mode">üì∞</button>
          </div>
        </div>
      </div>

      <!-- ============================================
            INPUT SECTION
      ============================================ -->
      <div class="card p-4 mb-4" id="inputSection">
        <h3 class="fw-bold" id="inputTitle">‡¶ã‡¶£‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø</h3>

        <div class="row g-3">
          <div class="col-md-6">
            <label class="fw-bold" id="lblName">‡¶ã‡¶£‡¶ó‡ßç‡¶∞‡¶π‡ßÄ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ</label>
            <input class="form-control" id="name" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®"/>
          </div>

          <div class="col-md-6">
            <label class="fw-bold" id="lblLoan">‡¶ã‡¶£‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£</label>
            <input class="form-control" id="loan" placeholder="100000"/>
          </div>

          <div class="col-md-4">
            <label class="fw-bold" id="lblMonths">‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ (‡¶Æ‡¶æ‡¶∏)</label>
            <input class="form-control" id="months" placeholder="60"/>
          </div>

          <div class="col-md-4">
            <label class="fw-bold" id="lblRate">‡¶∏‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞ (%)</label>
            <input class="form-control" id="rate" placeholder="13.40"/>
          </div>

          <div class="col-md-4">
            <label class="fw-bold" id="lblSalary">‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶®‡ßá‡¶ü ‡¶¨‡ßá‡¶§‡¶®</label>
            <input class="form-control" id="salary" placeholder="0"/>
          </div>

          <div class="col-md-4">
            <label class="fw-bold" id="lblSalaryPercent">‡¶¨‡ßá‡¶§‡¶®‡ßá‡¶∞ ‡¶ï‡¶§ ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂ ‡¶¨‡¶ø‡¶¨‡ßá‡¶ö‡ßç‡¶Ø?</label>
            <input class="form-control" id="salaryPercent" placeholder="80"/>
          </div>
        </div>

        <div class="text-center mt-4">
          <button class="btn btn-primary btn-lg px-5" id="btnCalc" type="button" onclick="calculateAll()">
            ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®
          </button>
        </div>

        <div class="mt-3 small text-muted" id="noteSmall">
          ‡¶®‡ßã‡¶ü: ‡¶è‡¶ü‡¶ø ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá‡•§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï‡ßá‡¶∞ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ú/‡¶´‡¶ø/‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶´‡¶≤ ‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
        </div>
      </div>

      <!-- ============================================
            EMI TABS
      ============================================ -->
      <ul class="nav nav-tabs" id="emiTabs">
        <li class="nav-item">
          <button class="nav-link active" id="tabBtnEP" data-bs-toggle="tab" data-bs-target="#tab-ep" type="button">
            ‡¶∏‡¶Æ‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á
          </button>
        </li>
        <li class="nav-item">
          <button class="nav-link" id="tabBtnDB" data-bs-toggle="tab" data-bs-target="#tab-db" type="button">
            ‡¶°‡¶ø‡¶ï‡ßç‡¶≤‡¶æ‡¶á‡¶®‡¶ø‡¶Ç ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á
          </button>
        </li>
      </ul>

      <div class="tab-content mt-3">
        <!-- EQUAL PRINCIPAL EMI TAB -->
        <div class="tab-pane fade show active" id="tab-ep">
          <div id="results-ep"></div>

          <div class="card p-3 chart-container" id="chartContainerEP" style="display:none;">
            <canvas id="emiChartEP"></canvas>
          </div>

          <div id="schedule-ep"></div>
        </div>

        <!-- DECLINING EMI TAB -->
        <div class="tab-pane fade" id="tab-db">
          <div id="results-db"></div>
          <div id="schedule-db"></div>
        </div>
      </div>

      <!-- Print Button -->
      <div class="text-center mt-3" id="actions" style="display:none;">
        <button class="btn btn-secondary" id="btnPrint" type="button" onclick="window.print()">PDF / Print</button>
      </div>

    </div>
  </div>

  <!-- Footer Trust -->
  
  <!-- AUTHOR & TRUST (E-E-A-T) -->
  <section class="page-wrap" id="author-trust">
    <div class="card p-4 mb-4">
      <h2>About the Author</h2>
      <p class="text-muted">
        I‚Äôm <strong>Abdul Latif</strong>, a banking professional at <strong>Agrani Bank PLC</strong> (Bangladesh).
        I work with loan cases, repayment planning, and banking documentation.
        This tool and the explanations are built from real banking math and field experience.
      </p>

      <h3>Why you can trust this calculator</h3>
      <ul>
        <li>Uses standard reducing-balance and equal-principal formulas</li>
        <li>Shows full amortization schedules (month-by-month)</li>
        <li>Designed for education, not promotion</li>
      </ul>

      <p class="text-muted mb-0">
        Note: Always confirm final EMI, fees, and terms with your bank before signing any agreement.
      </p>
    </div>
  </section>

<div class="footer-trust">
    <a href="/privacy-policy.html">Privacy Policy</a> |
    <a href="/terms.html">Terms</a> |
    <a href="/cookie-policy.html">Cookie Policy</a> |
    <a href="/disclaimer.html">Disclaimer</a> |
    <a href="/contact.html">Contact</a>
    <div style="margin-top:8px;">¬© 2026 Abdul Latif ‚Äî All Rights Reserved.</div>
  </div>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    /* ===================================================
          UTIL
    ==================================================== */
    function num(id){
      let el = document.getElementById(id);
      let v = (el.value || "").trim();
      if(!v) v = (el.placeholder || "").trim();
      v = String(v).replace(/,/g,'');
      return parseFloat(v) || 0;
    }

    function format(n){
      return Number(n).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2});
    }

    // Always keep ‡ß≥
    function money(n){
      return "‡ß≥ " + format(n);
    }

    // i18n helpers
    let currentLang = localStorage.getItem("emi_lang_full_v2") || "bn";
    let chartEP = null;

    const I18N = {
      bn: {
        // topbar
        tbTitle: "Loan EMI Calculator",
        tbSub: "‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ‡¶¶‡ßá‡¶∂ ‚Ä¢ Declining Balance ‡¶¨‡¶®‡¶æ‡¶Æ Equal Principal",
        tbMain: "‚Üê ‡¶Æ‡ßá‡¶á‡¶® ‡¶∏‡¶æ‡¶á‡¶ü",
        tbBlog: "‡¶¨‡ßç‡¶≤‡¶ó",

        // page
        mainTitle: "‡¶ã‡¶£ ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á ‡¶ì ‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡¶ï‡ßÅ‡¶≤‡ßá‡¶ü‡¶∞",
        inputTitle: "‡¶ã‡¶£‡ßá‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø",
        lblName: "‡¶ã‡¶£‡¶ó‡ßç‡¶∞‡¶π‡ßÄ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ",
        phName: "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®",
        lblLoan: "‡¶ã‡¶£‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£",
        lblMonths: "‡¶Æ‡ßá‡ßü‡¶æ‡¶¶ (‡¶Æ‡¶æ‡¶∏)",
        lblRate: "‡¶∏‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶∞ (%)",
        lblSalary: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶®‡ßá‡¶ü ‡¶¨‡ßá‡¶§‡¶®",
        lblSalaryPercent: "‡¶¨‡ßá‡¶§‡¶®‡ßá‡¶∞ ‡¶ï‡¶§ ‡¶∂‡¶§‡¶æ‡¶Ç‡¶∂ ‡¶¨‡¶ø‡¶¨‡ßá‡¶ö‡ßç‡¶Ø?",
        btnCalc: "‡¶á‡¶è‡¶Æ‡¶Ü‡¶á ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶ï‡¶∞‡ßÅ‡¶®",
        noteSmall: "‡¶®‡ßã‡¶ü: ‡¶è‡¶ü‡¶ø ‡¶∂‡¶ø‡¶ï‡ßç‡¶∑‡¶æ‡¶Æ‡ßÇ‡¶≤‡¶ï ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø‡ßá‡•§ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶Ç‡¶ï‡ßá‡¶∞ ‡¶ö‡¶æ‡¶∞‡ßç‡¶ú/‡¶´‡¶ø/‡¶∞‡¶æ‡¶â‡¶®‡ßç‡¶°‡¶ø‡¶Ç ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶´‡¶≤ ‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§",

        tabEP: "‡¶∏‡¶Æ‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á",
        tabDB: "‡¶°‡¶ø‡¶ï‡ßç‡¶≤‡¶æ‡¶á‡¶®‡¶ø‡¶Ç ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á",
        btnPrint: "PDF / Print",

        // summaries
        sumEPTitle: (loan)=>`‡¶ã‡¶£‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ (‡¶∏‡¶Æ‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®) ‚Äì ${money(loan)} ‡¶ã‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø`,
        sumDBTitle: (loan)=>`‡¶ã‡¶£‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ (‡¶°‡¶ø‡¶ï‡ßç‡¶≤‡¶æ‡¶á‡¶®‡¶ø‡¶Ç ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á) ‚Äì ${money(loan)} ‡¶ã‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø`,
        borrowerName: "‡¶ã‡¶£‡¶ó‡ßç‡¶∞‡¶π‡ßÄ‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ",
        salaryPortion: (pct)=>`‡¶¨‡ßá‡¶§‡¶®‡ßá‡¶∞ ${pct}%`,
        monthlyPrincipal: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®",
        totalInterest: "‡¶Æ‡ßã‡¶ü ‡¶∏‡ßÅ‡¶¶",
        monthlyInterest: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡ßÅ‡¶¶",
        monthlyInstall: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø",
        tenure: "‡¶Æ‡ßá‡ßü‡¶æ‡¶¶",
        emi: "‡¶á‡¶è‡¶Æ‡¶Ü‡¶á",

        // schedules
        epScheduleTitle: "‡¶∏‡¶Æ‡¶æ‡¶® ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶® - ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ",
        dbScheduleTitle: "‡¶°‡¶ø‡¶ï‡ßç‡¶≤‡¶æ‡¶á‡¶®‡¶ø‡¶Ç ‡¶á‡¶è‡¶Æ‡¶Ü‡¶á - ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ",
        thMonth: "‡¶Æ‡¶æ‡¶∏",
        thOpen: "‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶∞ ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®",
        thPrincipal: "‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®",
        thClose: "‡¶∂‡ßá‡¶∑ ‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®",
        thInterest: "‡¶∏‡ßÅ‡¶¶",
        thMonthlyInterest: "‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡ßÅ‡¶¶",
        thCumInterest: "‡¶∏‡¶Æ‡¶∑‡ßç‡¶ü‡¶ø‡¶ó‡¶§ ‡¶∏‡ßÅ‡¶¶",
        thRemain: "‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü",
        thEMI: "‡¶á‡¶è‡¶Æ‡¶Ü‡¶á",
        thEnd: "‡¶∂‡ßá‡¶∑"
      },

      en: {
        // topbar
        tbTitle: "Loan EMI Calculator",
        tbSub: "Bangladesh ‚Ä¢ Declining Balance vs Equal Principal",
        tbMain: "‚Üê Main Site",
        tbBlog: "Blog",

        // page
        mainTitle: "Loan EMI & Eligibility Calculator",
        inputTitle: "Loan Information",
        lblName: "Borrower Name",
        phName: "Type your name",
        lblLoan: "Loan Amount",
        lblMonths: "Tenure (Months)",
        lblRate: "Interest Rate (%)",
        lblSalary: "Monthly Net Salary",
        lblSalaryPercent: "Salary Portion Considered (%)",
        btnCalc: "Calculate EMI",
        noteSmall: "Note: This is an educational estimate. Final bank figure may vary due to fees, policy, and rounding.",

        tabEP: "Equal Principal Method",
        tabDB: "Declining Balance EMI",
        btnPrint: "PDF / Print",

        // summaries
        sumEPTitle: (loan)=>`Loan Summary (Equal Principal) ‚Äì For ${money(loan)}`,
        sumDBTitle: (loan)=>`Loan Summary (Declining EMI) ‚Äì For ${money(loan)}`,
        borrowerName: "Borrower Name",
        salaryPortion: (pct)=>`Salary Portion (${pct}%)`,
        monthlyPrincipal: "Monthly Principal",
        totalInterest: "Total Interest",
        monthlyInterest: "Avg. Monthly Interest",
        monthlyInstall: "Monthly Installment",
        tenure: "Tenure",
        emi: "EMI",

        // schedules
        epScheduleTitle: "Equal Principal ‚Äì Full Amortization Schedule",
        dbScheduleTitle: "Declining EMI ‚Äì Full Amortization Schedule",
        thMonth: "Month",
        thOpen: "Opening Principal",
        thPrincipal: "Principal",
        thClose: "Closing Principal",
        thInterest: "Interest",
        thMonthlyInterest: "Avg Interest",
        thCumInterest: "Cumulative Interest",
        thRemain: "Balance (Diff)",
        thEMI: "EMI",
        thEnd: "Closing"
      }
    };

    function setLang(lang){
      currentLang = lang;
      localStorage.setItem("emi_lang_full_v2", lang);

      document.documentElement.lang = (lang === "bn" ? "bn" : "en");

      const L = I18N[lang];

      // topbar
      document.getElementById("tbTitle").textContent = L.tbTitle;
      document.getElementById("tbSub").textContent = L.tbSub;
      document.getElementById("tbMain").textContent = L.tbMain;
      document.getElementById("tbBlog").textContent = L.tbBlog;

      // page
      document.getElementById("mainTitle").textContent = L.mainTitle;
      document.getElementById("inputTitle").textContent = L.inputTitle;
      document.getElementById("lblName").textContent = L.lblName;
      document.getElementById("name").placeholder = L.phName;
      document.getElementById("lblLoan").textContent = L.lblLoan;
      document.getElementById("lblMonths").textContent = L.lblMonths;
      document.getElementById("lblRate").textContent = L.lblRate;
      document.getElementById("lblSalary").textContent = L.lblSalary;
      document.getElementById("lblSalaryPercent").textContent = L.lblSalaryPercent;
      document.getElementById("btnCalc").textContent = L.btnCalc;
      document.getElementById("noteSmall").textContent = L.noteSmall;
      document.getElementById("tabBtnEP").textContent = L.tabEP;
      document.getElementById("tabBtnDB").textContent = L.tabDB;
      document.getElementById("btnPrint").textContent = L.btnPrint;

      // toggle label
      const toggle = document.getElementById("langToggleBtn");
      if(toggle) toggle.textContent = (lang === "bn") ? "EN" : "BN";

      // If results already calculated, re-render them in current language
      if(window.__lastCalc){
        calculateAll(true);
      }
    }

    // theme (keep simple)
    document.getElementById("theme-light").onclick=()=>document.body.className="py-4";
    document.getElementById("theme-print").onclick=()=>document.body.className="py-4 theme-printlike";

    /* ===================================================
          SMART MESSAGE (BN + EN)
    ==================================================== */
    function smartMessage(salaryPortion, monthlyInstall){
      let remaining = salaryPortion - monthlyInstall;
      let pct = salaryPortion > 0 ? (remaining / salaryPortion) * 100 : 0;

      // EN texts
      const EN = {
        veryRisky: (p)=>`<div class="alert-custom">
          ‚ö† <b>Very risky!</b><br>
          After EMI, only <b>${p}%</b> of salary portion remains ‚Äî may disrupt living expenses.
        </div>`,
        risky: (p)=>`<div class="alert-custom">
          ‚ö† <b>Risk exists!</b><br>
          Only <b>${p}%</b> remains ‚Äî monthly expenses may feel tight.
        </div>`,
        ok: (p)=>`<div class="alert-success-custom">
          ‚úî <b>Acceptable</b><br>
          <b>${p}%</b> remains ‚Äî but savings may reduce.
        </div>`,
        safe: (p)=>`<div class="alert-success-custom">
          ‚úî <b>Safer choice!</b><br>
          <b>${p}%</b> remains after EMI ‚Äî more stable.
        </div>`
      };

      // BN texts
      const BN = {
        veryRisky: (p)=>`<div class="alert-custom">
          ‚ö† <b>‡¶Ö‡¶§‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£!</b><br>
          ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶™‡¶∞ ‡¶¨‡ßá‡¶§‡¶®‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞ <b>${p}%</b> ‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶•‡¶æ‡¶ï‡ßá ‚Äî ‡¶ú‡ßÄ‡¶¨‡¶®‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶π‡¶§ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
        </div>`,
        risky: (p)=>`<div class="alert-custom">
          ‚ö† <b>‡¶ù‡ßÅ‡¶Å‡¶ï‡¶ø ‡¶∞‡ßü‡ßá‡¶õ‡ßá!</b><br>
          ‡¶π‡¶æ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá <b>${p}%</b> ‚Äî ‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ñ‡¶∞‡¶ö ‡¶ö‡¶æ‡¶™ ‡¶∏‡ßÉ‡¶∑‡ßç‡¶ü‡¶ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
        </div>`,
        ok: (p)=>`<div class="alert-success-custom">
          ‚úî <b>‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø</b><br>
          ‡¶π‡¶æ‡¶§‡ßá ‡¶•‡¶æ‡¶ï‡ßá <b>${p}%</b> ‚Äî ‡¶§‡¶¨‡ßá ‡¶∏‡¶û‡ßç‡¶ö‡ßü ‡¶ï‡¶Æ ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§
        </div>`,
        safe: (p)=>`<div class="alert-success-custom">
          ‚úî <b>‡¶®‡¶ø‡¶∞‡¶æ‡¶™‡¶¶ ‡¶∏‡¶ø‡¶¶‡ßç‡¶ß‡¶æ‡¶®‡ßç‡¶§!</b><br>
          ‡¶ï‡¶ø‡¶∏‡ßç‡¶§‡¶ø ‡¶™‡¶∞ ‡¶¨‡ßá‡¶§‡¶®‡ßá‡¶∞ <b>${p}%</b> ‡¶Ö‡¶¨‡¶∂‡¶ø‡¶∑‡ßç‡¶ü ‡¶•‡¶æ‡¶ï‡ßá ‚Äî ‡¶∏‡ßç‡¶•‡¶ø‡¶§‡¶ø‡¶∂‡ßÄ‡¶≤‡•§
        </div>`
      };

      const p = pct.toFixed(1);

      if(pct < 5)  return (currentLang==="bn" ? BN.veryRisky(p) : EN.veryRisky(p));
      if(pct < 15) return (currentLang==="bn" ? BN.risky(p)    : EN.risky(p));
      if(pct < 30) return (currentLang==="bn" ? BN.ok(p)       : EN.ok(p));
      return (currentLang==="bn" ? BN.safe(p)   : EN.safe(p));
    }

    /* ===================================================
          MAIN CALCULATOR
          keep logic same, only label rendering changes
    ==================================================== */
    function calculateAll(isRerender=false){
      let name = document.getElementById("name").value;
      let loan = num("loan");
      let months = num("months");
      let rate = num("rate")/100;
      let salary = num("salary");
      let salaryPercent = num("salaryPercent") || 80;

      let salaryPortion = salary * (salaryPercent/100);
      let r = (rate/12)*1.016666667;

      // Save last state (for rerender)
      window.__lastCalc = {name,loan,months,rate,salary,salaryPercent};

      calcEP(name,loan,months,salaryPortion,salaryPercent,r);
      calcDB(name,loan,months,salaryPortion,salaryPercent,r);

      document.getElementById("actions").style.display="block";
    }

    /* ===================================================
          EQUAL PRINCIPAL EMI (same math)
    ==================================================== */
    function calcEP(name,loan,months,salaryPortion,salaryPercent,r){

      let principal = loan/months;
      let bal = loan;
      let totalInterest=0;
      let data=[];

      for(let m=1;m<=months;m++){
        let interest = bal*r;
        totalInterest += interest;
        let close = bal - principal;
        data.push({month:m,open:bal,principal:principal,close:close,interest:interest});
        bal = close;
      }

      let monthlyInterest = totalInterest/months;
      let monthlyInstall = monthlyInterest + principal;

      const L = I18N[currentLang];

      document.getElementById("results-ep").innerHTML = `
        <div class="card p-4 mb-3 summary-card">
          <h3 class="fw-bold">${L.sumEPTitle(loan)}</h3>

          <div class="row mt-3">
            <div class="col-md-4">
              <p><strong>${L.borrowerName}:</strong> ${name || "N/A"}</p>
              <p><strong>${L.salaryPortion(salaryPercent)}:</strong> ${money(salaryPortion)}</p>
              <p><strong>${L.monthlyPrincipal}:</strong> ${money(principal)}</p>
            </div>

            <div class="col-md-4">
              <p><strong>${L.totalInterest}:</strong> ${money(totalInterest)}</p>
              <p><strong>${L.monthlyInterest}:</strong> ${money(monthlyInterest)}</p>
              <p><strong>${L.monthlyInstall}:</strong> ${money(monthlyInstall)}</p>
            </div>

            <div class="col-md-4 text-center">
              <div class="qr-box" id="qrEP"></div>
            </div>
          </div>

          <div id="eligMsg" class="mt-3">
            ${ smartMessage(salaryPortion, monthlyInstall) }
          </div>
        </div>`;

      // QR
      try{
        document.getElementById("qrEP").innerHTML = "";
        new QRCode(document.getElementById("qrEP"),{
          text:"https://www.ablatif.com/emi/loan_emi_full.html",
          width:120, height:120
        });
      }catch(e){}

      // Graph (keep simple)
      let labels=data.map(d=>d.month);
      let interestData=data.map(d=>d.interest);
      let principalData=data.map(d=>d.principal);

      if(chartEP) chartEP.destroy();
      document.getElementById("chartContainerEP").style.display="block";

      chartEP = new Chart(document.getElementById("emiChartEP"),{
        type:"line",
        data:{
          labels:labels,
          datasets:[
            {label:(currentLang==="bn"?"‡¶∏‡ßÅ‡¶¶":"Interest"), data:interestData, borderColor:"red", borderWidth:2, tension:0.25},
            {label:(currentLang==="bn"?"‡¶Æ‡ßÇ‡¶≤‡¶ß‡¶®":"Principal"), data:principalData, borderColor:"green", borderWidth:2, tension:0.25}
          ]
        },
        options:{ responsive:true, maintainAspectRatio:false }
      });

      // Schedule
      let rows=""; let cumulative=0;

      for(let d of data){
        cumulative+=d.interest;
        let balInt = cumulative - monthlyInterest*d.month;

        rows+=`
          <tr>
            <td>${d.month}</td>
            <td>${money(d.open)}</td>
            <td>${money(d.principal)}</td>
            <td>${money(d.close)}</td>
            <td>${money(d.interest)}</td>
            <td>${money(monthlyInterest)}</td>
            <td>${money(cumulative)}</td>
            <td>${money(balInt)}</td>
          </tr>`;
      }

      document.getElementById("schedule-ep").innerHTML = `
        <div class="card p-4 page-break">
          <h4 class="fw-bold">${L.epScheduleTitle}</h4>

          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>${L.thMonth}</th>
                  <th>${L.thOpen}</th>
                  <th>${L.thPrincipal}</th>
                  <th>${L.thClose}</th>
                  <th>${L.thInterest}</th>
                  <th>${L.thMonthlyInterest}</th>
                  <th>${L.thCumInterest}</th>
                  <th>${L.thRemain}</th>
                </tr>
              </thead>
              <tbody>${rows}</tbody>
            </table>
          </div>
        </div>`;
    }

    /* ===================================================
          DECLINING EMI (same math + safety for edge cases)
    ==================================================== */
    function calcDB(name,loan,months,salaryPortion,salaryPercent,r){

      // Avoid divide by zero if rate = 0
      let emi = 0;
      if(r === 0){
        emi = loan / months;
      }else{
        const pow = Math.pow(1+r,months);
        emi = loan*r*pow/(pow-1);
      }

      let bal=loan, totalInterest=0, rows="";

      for(let m=1;m<=months;m++){
        let interest=bal*r;
        let principal=emi-interest;
        let close=bal-principal;
        totalInterest+=interest;

        rows+=`
          <tr>
            <td>${m}</td>
            <td>${money(bal)}</td>
            <td>${money(emi)}</td>
            <td>${money(interest)}</td>
            <td>${money(principal)}</td>
            <td>${money(close)}</td>
          </tr>`;

        bal=close;
      }

      const L = I18N[currentLang];

      document.getElementById("results-db").innerHTML = `
        <div class="card p-4 mb-3">
          <h3 class="fw-bold">${L.sumDBTitle(loan)}</h3>

          <div class="row mt-3">
            <div class="col-md-6">
              <p><strong>${L.borrowerName}:</strong> ${name || "N/A"}</p>
              <p><strong>${L.salaryPortion(salaryPercent)}:</strong> ${money(salaryPortion)}</p>
              <p><strong>${L.tenure}:</strong> ${months} ${currentLang==="bn"?"‡¶Æ‡¶æ‡¶∏":"months"}</p>
            </div>

            <div class="col-md-6">
              <p><strong>${L.emi}:</strong> ${money(emi)}</p>
              <p><strong>${L.totalInterest}:</strong> ${money(totalInterest)}</p>
            </div>
          </div>

          ${ smartMessage(salaryPortion, emi) }
        </div>`;

      document.getElementById("schedule-db").innerHTML = `
        <div class="card p-4 page-break">
          <h4 class="fw-bold">${L.dbScheduleTitle}</h4>

          <div class="table-responsive mt-3">
            <table class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>${L.thMonth}</th>
                  <th>${L.thOpen}</th>
                  <th>${L.thEMI}</th>
                  <th>${L.thInterest}</th>
                  <th>${L.thPrincipal}</th>
                  <th>${L.thEnd}</th>
                </tr>
              </thead>
              <tbody>${rows}</tbody>
            </table>
          </div>
        </div>`;
    }

    // Topbar toggle only
    document.getElementById("langToggleBtn").addEventListener("click", function(){
      setLang(currentLang === "bn" ? "en" : "bn");
    });

    // Default Bangla
    window.addEventListener("load", function(){
      setLang(currentLang || "bn");
    });
  </script>
</body>
</html>
